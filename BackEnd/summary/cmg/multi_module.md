## 서버들을 단일 프로젝트로 만들게 되면 발생하는 문제

- 공통으로 처리해야 하는 코드의 처리
    - 공통되는 코드들을 각 프로젝트에 복붙해서 사용해야 한다
    - 한 파일의 코드를 수정하면 다른 프로젝트의 코드도 수정해야 한다
- 접근성 문제
    - 프로젝트의 수에 따라 IDE를 실행시켜야 한다.

## 멀티 모듈

- 기존의 단일 프로젝트를 프로젝트 안의 모듈로서 가질 수 있는 구조를 제공
- `하나의 시스템`을 단위로 만들어진다!
    - **서비스** : 독립적으로 실행 가능한 에플리케이션
    - **시스템** : 1개 이상의 서비스 + 공유 인프라

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/b33999aa-eca7-45a5-95b2-9f09bf79ac96/Untitled.png)

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/bbc420b8-8334-4fa6-9dfa-9b91190d0666/Untitled.png)

## MSA에서 멀티 모듈이 부각되는 이유?

- 역할, 의존성의 분리를 통해 시스템의 분리, 통합을 유연하게 만들어 줄 수 있는 `좋은 아키텍처`를 만들 수 있기 때문
- 좋은 아키텍처란
    - 시스템이 모노리틱 구조로 배포되더라도, 이후에는 배포 가능한 단위들의 집합으로 성장
    - 독립적인 서비스나 마이크로서비스 수준까지 성장할 수 있음
    - 상황이 바뀌었을 때 진행 방향을 거꾸로 돌려 `원래 형태`인 모노리틱 구조로 되돌릴 수도 있어야 한다.
    - 의존성 분리를 통해 시스템의 분리와 통합을 유연하게 만듬
- 모놀리틱 ←→ MSA 간 전환이 용이한 아키텍처를 만들 수 있기 때문

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/0fd661fc-aa5e-49f8-9407-ee5001fef350/Untitled.png)

- 다음과 같은 상황에서 “Member”라는 클래스가 공유(중복)되고 있다
    - 그렇다고 다른 프로젝트에 함부로 복붙할 수도 없고…

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/d1d043f5-8b44-42c1-83a3-207eb2910064/Untitled.png)

- 프로젝트는 하나이지만, 그 안에 여러 개의 모듈을 설치!
- 장점
    - IDE를 1개만 사용
    - 시스템적으로 보장되는 일관성
    - 빠른 개발 사이클 확보 가능
- common 모듈을 만들어 공통적인 기능을 몰아넣는 행위에 빠지면 안됨
    - common 안에서 비즈니스가 흐르게 됨
    - 여러 클래스가 서로에게 의존하는 스파게티 코드가 됨
    - common이 너무 커져 분리가 불가능해짐
    - 특정 기능이 사라져도 의존도가 너무 높아도 관련 클래스 제거 불가
    - 사용하지 않는 것들에 대해서도 의존해야 함 (ex. DB를 사용하지 않는 클래스도 DB에 의존성을 가져 연결되게 됨)

## 모듈이 가진 특징

- 독립적인 의미를 갖는다
- 어떠한 추상화 정도에 대한 계층을 가지고 있다.
- 계층 간 의존 관계에 대한 규칙이 있다.

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/d1f395e7-4675-4202-84aa-cc4326087935/Untitled.png)

- 다음 구조가 가진 계층
    1. 독립 모듈 계층 (외부 시스템)
    2. 도메인 모듈 계층
    3. 내부 모듈 계층
    4. 공통 모듈 계층
    5. 어플리케이션 모듈 계층

## 멀티 모듈이 갖는 모듈들

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/8f34f25a-a224-4347-a438-7270b325ac9f/Untitled.png)

### 독립 모듈 계층

- 시스템과 무관하게 어디에서나 사용 가능한 라이브러리 성격의 모듈
- 시스템, 도메인의 비즈니스와 별개로 자체 제작한 라이브러리 등
- 자체로서 `독립적인 역할`을 가짐
- **프로젝트 내에 의존 관계를 두지 않아야 한다!**

---

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/b5e3625a-2186-4866-919a-1225a43f974e/Untitled.png)

### 공통 모듈 계층

- 모든 모듈에서 공통으로 사용되는 것들에 대한 계층
- 반드시 명심해야 하는 규칙
    - Type, Util 등을 정의한다
    - `가능하면 사용하지 않는다`
- 의존성 덩어리가 되면 안된다.
    - 시스템 내 모든 모듈들이 의존할 수 있을 만큼 얇은 의존성

---

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/458fd7a6-056f-4138-8cf5-febe6665d595/Untitled.png)

### 도메인 모듈 계층

- 시스템의 중심 도메인을 다루는 모듈이 존재하는 계층
- 원칙
    1. 서비스 비즈니스를 모른다.
    2. 하나의 모듈은 최대 하나의 인프라 스트럭처에 대한 책임만 갖는다.
    3. 도메인 모듈을 조합한 더 큰 단위의 도메인 모듈이 있을 수 있다.
- 프로젝트의 어떠한 실행 가능한 어플리케이션에서도 사용 가능한 모듈이 위치
- 저장소 외 시스템 특성을 알지 않아야 하기 때문에 `내부 모듈` 계층을 의존하지 않는다.

---

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/7e8ed86a-78b9-4675-a59e-8bb4df16932d/Untitled.png)

### 내부 모듈 계층

- 저장소, 도메인 외 시스템에서 필요한 모듈들
- 시스템과 연관이 있는 모듈
- 원칙
    - 어플리케이션, 도메인 비즈니스를 모른다.

---

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/38ed9108-8b95-4227-bf61-9f13b0a667ff/Untitled.png)

### 어플리케이션 모듈 계층

- 독립적으로 실행 가능한 어플리케이션 모듈 계층
- 모듈들을 조립하여 서비스 비즈니스를 완성

---

## 멀티모듈 구성 효과